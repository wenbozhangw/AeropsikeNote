# service配置参数

## 一、参数配置

| name | default | subcontext | tag | note |
|--- | --- | --- | --- |---|
| `advertise-ipv6` | false | | `enterprise` Introduced : 3.10 | 需要心跳v3。设置为true启动IPv6 |
| ~~allow-inline-transactions~~ | true | removed:3.11 | 默认情况下，内存中的读操作由服务线程直接处理，而不是卸载转移到操作队列，然后由操作线程拾取。将 allow-inline-transactions设置为false将强制所有操作分配到一个操作队列。这在有限的网络队列和/或服务线程的环境中很有帮助。 <br/> 要在整个集群中禁用内联操作： <br/> `asadm -e "asinfo -v 'set-config:context=service;allow-inline-transactions=false'"` |
| batch-index-threads | #cpu | | Introduced : 3.6.0 | 批处理索引响应工作线程数。在版本3.12+中，默认情况下将其设置为可用的CPU内核数。在以前的版本中，默认值为4。每个线程都有自己的队列。这些线程只处理通过套接字将批处理响应缓冲区发送回客户端。值范围：1-256。<br />动态设置 batch-index-threads 为16：<br />`asinfo -v "set-config:context=service;batch-index-threads=16"`<br />Tip: 3.12版本之前允许最大值为64。 |
| batch-max-buffers-per-queue | 255 | | Introduced : 3.6.0 | 每个批处理索引队列中被标记为已满之前允许的128KB响应缓冲区的数量。批处理索引队列（每个批处理索引线程一个）可以具有多于`batch-max-buffers-per-queue`缓冲区，但是直到它低于该数量，它才会接收任何新的批处理。当所有的队列都大于`batch-max-buffers-per-queue`时，新的批处理请求将被拒绝，并且将在服务器上记录错误："*Failed to find active batch queue that is not full*."。<br />动态设置batch-max-buffers-per-queue为512：<br />`asinfo -v "set-config:context=service;batch-max-buffers-per-queue=512"` |
| batch-max-requests | 5000 | | | 每个节点允许的最大key个数。<br />动态设置batch-max-requests为6000：<br />`asinfo -v "set-config:context=service;batch-max-requests=6000"` |
| batch-max-unused-buffers | 256 | dynamic | 缓冲池中允许的最大128KB响应缓冲区的个数。如果达到限制，则已完成的缓冲区将在批处理请求结束时销毁。对于大量的批量工作负载，建议增加这个配置参数，以避免不必要的破坏和重新创建缓冲区，这会影响CPU负载。<br />动态设置 batch-max-unused-buffers为512：<br />`asinfo -v "set-config:context=service;batch-max-unused-buffers=512"` |
| ~~batch-priority~~ | 200 | | removed:4.4 | 生成前的顺序读取数。数字越大，优先级越高。仅适用于旧的batch direct协议，该协议已在版本4.4中删除。<br />动态设置 batch-priority为300：<br />`asinfo -v "set-config:context=service;batch-priority=300"` |
| ~~batch-threads~~ | 4 | | removed:4.4 | batch direct 工作线程的数量。batch direct是旧版的批处理协议。该线程处理完整的批处理请求。所有批处理线程只有一个批处理队列。值范围：0-256。注意旧的batch direct协议已经在4.4版本移除。<br />动态设置 batch-threads 为8：<br />`asinfo -v "set-config:context=service;batch-threads=8"`<br />tips: 3.12版本之前最大值为 64。 |
| batch-without-digests | false | | Introduced : 4.9 | 如果设置为true，则摘要不包括在批处理响应中。 <br/> `asinfo -v "set-config:context=service;batch-without-digests=true"` <br/> 要使用 `batch-without-digests` ，所需的最低客户端版本如下： <br/> - Java client version 4.4.5 - <br/> C client version 4.6.6 - <br/> C# client version 3.9.0 - <br/> PHP client version 7.4.2. - <br/> Python client version 3.9.0. - <br/> Node.js client version 3.12.0 |
| cluster-name | null | | Introduced : 3.10 (hb v3) | 仅适用于3.10版及更高版本的心跳v3。如果设置，则节点只能加入具有匹配 `cluster-name` 的集群。提供群集名称的客户端只能连接到与其名称匹配的群集。 <br/> `asinfo -v "set-config:context=service;cluster-name=payments"` |
| ~~defrag-queue-escape~~ | 10 | | Removed : 3.3.17 | 碎片整理线程可以休眠的最长时间（毫秒）。增加此数字可减慢碎片整理速度，减少此速度可加快整理速度。 |
| ~~defrag-queue-hwm~~ | 500 |  | Removed : 3.3.17 | 写入吞吐量限制，超出该限制将进行碎片整理。超过后，碎片整理将暂停，直到写入吞吐量低于 `defrag-queue-lwm` 或 `defrag-queue-escape` 毫秒（以先发生的为准）为止。在写入较高时使碎片整理速度变慢。增大此值将使碎片整理率略有增加。 |
| ~~defrag-queue-lwm~~ | 1 | | Removed : 3.3.17 | 写入吞吐量限制，低于此限制后，将在违反`defrag-queue-hwm`之后恢复碎片整理。在正常写入次数较少时唤醒碎片整理。该值必须低于defrag-queue-hwm。增大此值将使您的碎片整理率略有增加。 |
| ~~defrag-queue-priority~~ | 1 | | Removed : 3.3.17 | 碎片整理线程的优先级。较高的数值会减慢碎片整理的速度。 <br/> 这是在处理要进行碎片整理的每个块之间要等待的毫秒数。可以将其设置为0以进一步加快碎片整理的速度，但应仔细监视对磁盘I / O的影响。 |
| `downgrading` | | | `Enterprise` Introduced : 5.4.0.3, 5.3.0.8, 5.2.0.17 | 与以下版本的降级结合使用， [version 5.2 or newer (where XDR bin shipping has been used) to pre-5.2](https://docs.aerospike.com/docs/operations/upgrade/aerospike/special_upgrades/52_downgrade.html) or [version 5.4 or newer (where XDR bin convergence has been used) to  5.3 or 5.2](https://docs.aerospike.com/docs/operations/upgrade/aerospike/special_upgrades/54_to_53_or_52_downgrade.html) 。如果在降级之前将其设置为true，则在从具有较新服务器版本的节点向具有较旧版本的节点发送记录时，确保记录兼容性。 请注意，此参数只能动态设置。 <br/> `asinfo -v "set-config:context=service;downgrading=true"` |
| enable-benchmarks-fabric | false | | Introduced : 3.9 | 开启 fabric 的直方图。 详情参见 [Histograms from Aerospike Logs](https://docs.aerospike.com/docs/operations/monitor/latency/index.html) <br/> `asinfo -v 'set-config:context=service;enable-benchmarks-fabric=true'` |
| ~~enable-benchmarks-svc~~ | false | | Introduced : 3.9 Removed : 4.8 | 启用 反编列（demarshal）和 transaction 队列相关的操作 的直方图。详情参见 [Histograms from Aerospike Logs](https://docs.aerospike.com/docs/operations/monitor/latency/index.html) <br/> 在 4.8 中删除，在 4.7 中删除了 transaction 队列之后，队列直方图就变得无关紧要，并且 delmarshal 直方图几乎等于不同类型 transaction 的“ * -start”直方图：`ops-sub-start，read-start，write -start，udf-start，udf-sub-start和batch-sub-prestart` 。 <br/> `asinfo -v 'set-config:context=service;enable-benchmarks-svc=true'` |
| enable-health-check | false | | Introduced : 4.3.1.3 | 监视集群的运行状况，并尝试识别潜在的异常节点。如果怀疑某个节点在执行并影响整个集群，则很有帮助。这不能代替对集群的常规监控和警报，而是可以增强集群。为了获得最佳结果，必须在所有节点上明确启用此功能。请参考 `health-stats` 和 `health-outliers` 命令。 <br/> `asinfo -v "set-config:context=service;enable-health-check=true"` <br/> 讲师的统计信息分为 `cluster stats` 和 `local stats`。监控的集群统计信息包括打开的 fabric 连接，节点到达的数量，代理请求的数量和副本延迟。监控的本地统计信息包括设备读取延迟。 |
| enable-hist-info | false | | Introduced : 3.9 | 启用 protocol transaction info 的直方图。详情参见 [Histograms from Aerospike Logs](https://docs.aerospike.com/docs/operations/monitor/latency/index.html) <br/> `asinfo -v 'set-config:context=service;enable-hist-info=true'` |
| ~~generation-disable~~ | false | | Removed : 3.10 | 完全禁用 generation 检查。 <br/> 用于覆盖传递给服务器的客户端API选项。 |
| info-threads | 16 | | | 要创建以处理 info requests 的线程数。在 4.5.2 之前的版本中，此配置是静态的。对于服务器版本 4.5.2 及更高版本，最大允许值为256。值范围：1-256。 <br/> `asinfo -v "set-config:context=service;info-threads=8"` |
| ~~microbenchmarks~~ | false | | Removed : 3.9 | 为附加的日志记录启用微基准测试，以便调查复杂的问题/缓慢的 transactions 。在3.9中删除，并替换为启用命名空间级别配置的 benchmarks。有关详细信息，请参阅 [Histograms from Aerospike Logs](https://docs.aerospike.com/docs/operations/monitor/latency/index.html) 。|
| microsecond-histograms | false | | Introduced : 5.1 | 将直方图的粒度设置为微秒，而不是默认的毫秒。对于 [auto enabled](https://docs.aerospike.com/docs/operations/monitor/latency/index.html#-1-auto-enabled-benchmarks-) 的直方图，此配置是静态的，必须重新启动节点。 <br/> `asinfo -v "set-config:context=service;microsecond-histograms=true"` <br/> 将直方图时间单位写入日志文件时无法更改。对于始终写入日志的 [auto-enabled benchmarks](https://docs.aerospike.com/docs/operations/monitor/latency/index.html#auto-enabled-benchmarks)  ，必须重新启动节点才能切换到微秒。 对于启用配置的基准直方图，必须在动态更改 `microsecond-histograms` 设置之前关闭那些基准直方图。基准直方图是可以通过 `enable-benchmarks-xxx` 配置参数启用的所有基准。例如，`enable-benchmarks-read` 或 `enable-benchmarks-write`。请参考延迟监视页面或此配置参考手册上的完整列表。 |
| `migrate-fill-delay` | 0 | | `Enterprise` Introduced : 4.3.1 | 开始 `fill` 迁移之前要延迟的秒数。对于 [Available mode](https://docs.aerospike.com/docs/architecture/consistency.html#available-mode)(AP), 填充迁移是指向没有迁移分区的节点的迁移。对于 `strong-consistency` 而言，这些迁移都是向非 roster 副本进行的。如果群集状态是 `transient`（正常情况），则无需进行这些迁移-恢复群集状态时，最终将删除此迁移的数据。此设置不会影响 `migrate_tx_partitions_lead_remaining` 指示的“lead migrations”。有关更多详细信息，请参考 [Delaying "Fill" Migrations](https://docs.aerospike.com/docs/operations/manage/migration/delay_migrations/index.html) 。 <br/> 要在整个群集上启用一小时的填充延迟（由于重新启动将还原这种动态更改，因此也将在配置文件中更改）：<br/> `asadm -e "asinfo -v 'set-config:context=service;migrate-fill-delay=3600'"`  <br/> 对于5.2+版本，可以使用动态参数 `ignore-migrate-fill-delay` 为命名空间覆盖。 <br/> 对于版本4.5.0.2和更早版本，动态设置此配置参数时，无法使用时间单位（m，h，d）。 <br/> 对于启用了 `strong-consistency` 的名称空间，在停顿时，`migrate-fill-delay` 仅在节点停止后才开始“计数”。 <br/> 当增加`migration-fill-delay` 时间时，该扩展名将从迁移将要开始的起始点开始应用。 <br/> 任何集群更改（ `cluster_size` 更改）都将重置 `migrate-fill-delay` 时间。例如，将每个节点配置为延迟1小时（在配置文件中）的完集群关闭将防止在重新启动集群时发生“填充”迁移，只要每个节点至少有1个节点重新加入集群即可。1小时（ `cluster-stable` 命令可用于检查节点是否重新加入集群，并且必要时可以动态更新 `migrate-fill-delay` ）。 对于利用此设置的用例，一个好的做法是在配置文件中设置 `migration-fill-delay` ，以确保在滚动重启期间不会进行填充迁移，因为滚动重启会重置任何动态设置的参数。 <br/> 对于可用模式（AP），如果已停止的节点删除了其存储或被配置为仅具有`data-in-memeory`的命名空间，并且在停止之前没有被 `quiesced` 和完全迁移，则集群无法执行的时间段 满足由 `replication-factor` 配置设置的耐用性要求，并通过 `migrate-fill-delay` 扩展。 延迟结束或手动设置为0之前，迁移不会开始。 |
| migrate-max-num-incoming | 4 | | | 节点在任何给定时间可以从中接收记录的最大分区数。从3.10.1版本开始，默认值从256降低到4。这限制了给定节点上的潜在拥塞，尤其是在集群中添加了节点的情况下。可以谨慎地增加以加快迁移。有关更多详细信息，请参考 [manage migrations](https://docs.aerospike.com/docs/operations/manage/migration#speeding-up-the-migration-rate) 。 <br/> `asinfo -v "set-config:context=service;migrate-max-num-incoming=8"`  <br/> 对于3.13至3.15版本，最大值限制为64；对于3.16.0.1及更高版本，最大值为256。 <br/> 在某些情况下，在迁移期间允许更高数量的传入分区可能会对性能产生负面影响（特别是在于更高数量的 `migrate-threads` 结合时），甚至会导致意外的瓶颈，需要用较低的值重新启动节点。建议在监控网络和磁盘 IO 的潜在瓶颈时谨慎增加此参数。减小此值仅在处理数据的线程完成（一次完全分区）后生效。|
| ~~migrate-read-priority~~ | 10 | | Removed : 3.7.5 | 磁盘i/o节流用于数据迁移。在“migration -read-sleep”毫秒睡眠前读取的记录数。 <br/> 将此设置为0将禁用该调节旋钮。 |
| ~~migrate-read-sleep~~ | 500 | | Removed : 3.7.5 | 达到 `migrate-xmit-priority` 时的睡眠时间（以毫秒为单位）。如果将 `migration-xmit-priority` 设置为 0，则不会休眠。 |
| migrate-threads | 1 | 每个服务器分配用于数据迁移的线程数。每个线程将一次迁移一个分区。增大此参数时应格外小心。有关更多详细信息，请参考 [manage migrations](https://docs.aerospike.com/docs/operations/manage/migration#speeding-up-the-migration-rate) 。 值范围：0-100。在3.2.0之前不是动态的。 <br/> `asinfo -v "set-config:context=service;migrate-threads=2"`  <br/> 减小此值仅在处理数据的线程完成（一次完全分区）后生效。 |
| ~~migrate-xmit-hwm~~ | 10 | | Removed : 3.7.5 | 通过限制 `in-flight` 记录的数量，用于在迁移期间限制网络I / O 。 <br/> 增加此数量将加快迁移速度。 <br/> 高值会影响 transactions 延迟。 |
| ~~migrate-xmit-lwm~~ | 5 | | Removed : 3.7.5 | 当 `in-flight` 记录的数量低于此配置的值时，恢复迁移。 |
| ~~migrate-xmit-priority~~ | 40 | | Removed : 3.7.5 | 睡眠`migrate-xmit-sleep` 毫秒之前要发送的记录数。 <br/> 将此设置为0将禁用该调节旋钮。 | 
| ~~migrate-xmit-sleep~~ | 500 | | Removed : 3.7.5 | 达到`migrate-xmit-priority` 时的睡眠时间（以毫秒为单位）。如果将`migration-xmit-priority` 设置为0，则不会休眠。|
| min-cluster-size | 1 | | | 集群形成所需要的最小节点数。配置 `index-type flash` 时为必填，以避免在集群分裂时耗尽资源。 <br/> `asinfo -v "set-config:context=service;min-cluster-size=6"` <br/> 当在 `strong-consistency` 模式下运行时，如果所需的 `min-cluster-size` 少于集群中节点总数的一半，则不应配置 `min-cluster-size` 。实际上，少数子集群使所有分区都不可用，除了那些所有副本都在子集群中的分区，因此不需要新的分区所有权，也不需要增加索引设备空间或DRAM。这具有与配置 `min-cluster-size` 相同的目的，但是更好，因为子群集中会有一些可用性。如果在这种情况下配置了`min-cluster-size` ，则最终子群集中无法形成的节点将使所有内容不可用。） <br/> 同样，对于可用模式（AP）命名空间，当形成1节点子集群时，复制因子将降至1。所以复制因子为2时，如果未配置`min-cluster-size`，则在所需资源方面，一个1节点的子群集不会比2节点的子群集差。当然，对于大型群集，有必要将min-cluster-size配置为明显高于2或3。 <br/> 在其他较不常见的情况下，配置 `min-cluster-size` 可以提供帮助。例如，防止新节点无法加入集群以声明对所有分区的所有权（例如，解决云中DNS的问题），或者在跨多个机架运行时防止单个机架与其他机架分离而形成自己的集群 其他机架。 |
| ~~nsup-delete-sleep~~ | 100 | | Introduced : 3.4.0 Removed : 4.5.1 |  在版本4.5.1中已删除，因为nsup不再用于 delete transactions 。生成 delete transactions 之间要休眠的微秒数。 <br/> `asinfo -v "set-config:context=service;nsup-delete-sleep=50"`  <br/>  对于3.5.9之前的版本，默认值为0微秒，这可能会导致大量对象在set-delete中排队。 |
| ~~nsup-period~~ | 120 | | Removed : 4.5.1 | expiration/eviction 线程（namespace supervisor）唤醒的时间间隔(秒)。从4.3.0版开始，将nsup-period设置为0值将禁用所有命名空间的 namespace supervisor 。 <br/> `asinfo -v "set-config:context=service;nsup-period=60"` <br/> 在具有大量过期或已删除记录的系统上，可以将其安全地降低到60或30秒。 <br/> 如果在nsup工作时将nsup-period动态设置为零，则nsup将结束其当前周期，然后进入休眠状态。有关其他讨论，请参阅 [Namespace Data Retention Configuration](https://docs.aerospike.com/docs/operations/configure/namespace/retention/index.html) <br/> 从版本4.5.1开始移至 namespace 上下文。 |
| ~~nsup-queue-escape~~ | 10 | | Removed : 3.4.0 | expiration/eviction 线程休眠的最大时间(秒)。增加此数字可减慢到期/逐出速度，减少此数字可加快速度。 |
| ~~nsup-queue-hwm~~ | 500 | | Removed : 3.4.0 | 用于命名空间上的 expiration/eviction 的流控。 <br/> 增加此数字可加快驱逐速度，降低此速度可减慢驱逐速度。 |
| ~~nsup-queue-lwm~~ | 1 |  | Removed : 3.4.0 | 用于命名空间上的 expiration/eviction 的流控。增加可加快驱逐速度，而减少可减慢速度。该值必须低于 `nsup-queue-hwm` 。|
| ~~object-size-hist-period~~ | 3600 | | Introduced : 4.2.0.2 Removed : 4.5.1 | 从版本4.5.1开始移至 namespace 上下文，并重命名为 `nsup-hist-period` 。 <br/>  对象大小直方图的更新间隔（秒）。 <br/> 从版本4.3.0开始，将 `object-size-hist-period` 设置为0值将禁用对象大小直方图更新。有关对象大小直方图的更多详细信息，请参考 `histogram` 信息命令。 <br/> 如果 `object-size-hist-period` 动态设置为零，则获取对象大小直方图的后续info命令（如果存在）将返回生成的最后一个直方图。 |
| ~~paxos-protocol~~ | v3 | service | `unanimous` Removed : 3.14.0 | 集群中使用的Paxos协议版本。应为 `v1，v2，v3，v4，v5` 之一或 `none` 。 <br/> - v1 = 原始协议版本 <br/> - v2 = 可扩展的集群大小协议版本 <br/> - v3 = SIndex 查询节点协议版本 <br/> -v4 = 机架感知协议版本 <br/> - v5 = 所需的服务器版本 3.13 动态更改协议。 <br/> - none = 仅用于动态更改协议（仅适用于<3.13的版本） <br/> `paxos-protocol v5` |
| ~~paxos-recovery-policy~~ | auto-reset-master (as of 3.8.1) | | `unanimous` Introduced : 3.7.0.1 Removed : 3.13 (Paxos v5) | Paxos 配置可更好的自动恢复由网络不稳定引起的集群完整性问题。 <br/> 如果群集由于网络不稳定而经常出现裂脑情况，请将其设置为 `auto-reset-master` 。 |
| ~~paxos-retransmit-period~~ | 5 | | Removed : 3.14 | 用于重新运行paxos的检查的调整参数。 |
| ~~prole-extra-ttl~~ | 0 | | Introduced : 4.5.0.10 only <br/> Removed : 4.5.0.11 | 设置为非零值时，将激活过期副本记录的垃圾收集，并指定超出副本记录到到期时间的秒数，该记录有资格被此过程删除。包括在内，以支持在上时间升级期间在 SMD 协议两侧更改节点的集群。 [Aerospike 4.5.1 Special Upgrade Instructions](https://docs.aerospike.com/docs/operations/upgrade/aerospike/special_upgrades/4.5.1/index.html#preventing-replica-build-up) 有详细讨论。 |
| proto-fd-idle-ms | 0 | | | 建立连接之前等待的时间（以毫秒为单位）。默认值表示永远不会获得空闲连接。从 4.8 版本开始，Aerospike服务器对客户端 sockets 使用 keep-alive 。 <br/> `asinfo -v "set-config:context=service;proto-fd-idle-ms=70000"` <br/> 在5.1版之前，默认值为60000。 |
| proto-fd-max | 15000 | | | 代表客户端连接打开的 open file descriptors 的最大数量。 <br/> 可以增加以用于更高吞吐量的用例或吸收流量的临时峰值。 <br/> 最小值: 1024. 最大值: 2097152. <br/> 在Aerospike Server 启动时，此值不得超过 asd 进程的 system's file descriptor 限制。为避免启动问题，有两种选择 ： <br/> - 减少您的 Aerospike 配置文件中的 `proto-fd-max` 值。 <br/> - 增加 asd 进程的 system's file descriptor 限制。 <br/> 将`proto-fd-max` 动态设置为30000。在Aerospike Server 4.9之前的版本中，对于动态更改，仅当新值低于系统设置时才强制执行此限制。 <br/> `asinfo -v "set-config:context=service;proto-fd-max=30000"` <br/>  达到此限制时，客户端连接将被断开，并显示以下日志消息： <br/> `WARNING (service): (service.c:419) (repeated:103799) refusing client connection - proto-fd-max 50000` <br/> 此参数必须低于操作系统限制。有关更多详细信息，请参阅以下文章：[increase maximum number of openfiles](https://discuss.aerospike.com/t/increase-maximum-number-of-openfiles/1372) 。|
| proto-slow-netio-sleep-ms | 1ms | | | 此配置指定在发送 "slow" 查询的响应缓冲区时，重复尝试之间的睡眠时间。在重新排队响应时，当响应重新排队时，可作为意外网络拥塞期间的节流参数。 <br/> `asinfo -v "set-config:context=service;proto-slow-netio-sleep-ms=100"`  <br/> 无法在配置文件中设置此配置。因此，在服务器重启时，将需要再次对其进行动态配置。 |
| query-batch-size | 100 | | | 每个 I/O 请求查询执行的磁盘 I/O 数量。有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 页面。 <br/> `asinfo -v "set-config:context=service;query-batch-size=75"` |
| query-buf-size | 2MB | | | 二级索引查询执行网络 IO 时使用的缓冲区大小单位。用于避免过多的网络呼叫。减少此数量将意味着更频繁的网络 IO，从而改善 sockets 级别的响应。 <br/> `asinfo -v "set-config:context=service;query-buf-size=512000"` <br/> 该值只能动态设置。该值应以字节为单位。 |
| query-bufpool-size | 256 | | | 此配置指定在一个池中保留多少个缓冲区。可以在 1 到 UINT32_MAX 的范围内进行设置。可以使用 `query-buf-size` 配置执行网络 IO 的缓冲区大小单位。 <br/> `asinfo -v "set-config:context=service;query-bufpool-size=512"` |
| query-in-transaction-thread | false | | | 在 transaction 线程 (服务器版本在 4.7 之前) 或 service 线程 (服务器版本大于 4.7 )中运行查询，而不是使用 query threads。 当您希望查询在短时间内运行或命名空间在内存中时，请将其设置为 true。如果您希望运行更长的查询或命名空间使用磁盘存储，请将其设置为 false。有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) . <br/> `asinfo -v "set-config:context=service;query-in-transaction-thread=true"` <br/> 仅在运行长时间运行的查询或用于调试时才启用跟踪。默认情况下，`query_in_transaction_thread` 和 `query_req_in_query_thread` 设置为“ 0”。当数据库在内存中或查询返回较少的记录时，将它们设置为“ 1”。 |
| query-long-q-max-size | 500 | | | 长时间运行的查询队列中的查询数。长时间运行的查询返回的记录多于 `query-threshold`. 有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) . <br/> `asinfo -v "set-config:context=service;query-long-q-max-size=600"` |
| query-microbenchmark | false | | Introduced : 3.3.10 | 启用查询的 microbenchmark 。 |
| query-pre-reserve-partitions | | | | 此配置可用于在处理查询之前预先保留所有可查询分区。将此设置为 true 可能有助于减少某些用例正在进行的迁移过程中潜在的不一致窗口，但也会产生不利影响。企业许可证持有者可以通过Aerospike支持来讨论可以从此参数中受益的特定用例。 <br/> `asinfo -v "set-config:context=service;query-pre-reserve-partitions=true"` | 
| query-priority | 10 | | | 查询线程的优先级。在生成之前要读取的查询元素序列的数量（ `query-sleep-us` 微秒 ）。值越高，优先级越高。有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 。 <br/> `asinfo -v "set-config:context=service;query-priority=20"` | 
| query-priority-sleep-us | 1 | | | 读取 `query-priority` 查询元素序列后服务器暂停的时间（以微秒为单位）。有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 。 <br/>  `asinfo -v "set-config:context=service;query-priority-sleep-us=2"` |
| query-rec-count-bound | UINT64_MAX | | | 这是允许查询返回的最大记录数。返回超出此范围的查询将被终止。可以在 1 到 `UINT64_MAX` 的范围内进行配置。 <br/> `asinfo -v "set-config:context=service;query-rec-count-bound=512"` |
| query-req-in-query-thread | | | | 设置为 true 的配置将导致查询始终在主查询线程中处理，并且不会排队等待 `query-worker-threads` 处理。 <br/> `asinfo -v "set-config:context=service;query-req-in-query-thread=true"` |
| query-req-max-inflight | 100 | | | 每个查询一次可使用的查询 I/O 线程数。 有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 。 <br/> `asinfo -v "set-config:context=service;query-req-max-inflight=150"` |
| query-short-q-max-size | 500 | | | 短期运行的查询队列中的查询数。短暂运行的查询所需的记录少于 `query-threshold` 。  有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 。 <br/> `asinfo -v "set-config:context=service;query-short-q-max-size=600"` |
| query-threads | 6 | | | 节点上专用查询线程的数量。值范围：1-32 。 有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 。 <br/> `asinfo -v "set-config:context=service;query-threads=12"` |
| query-threshold | 10 | | | 短时间运行查询和长时间运行查询之间的分界线。返回的记录少于 `query threshold`  的查询是短时查询。所有其他的都是长时查询。有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 。 <br/> `asinfo -v "set-config:context=service;query-long-q-max-size=600"` |
| query-untracked-time-ms | 1000 | | | 默认情况下，将跟踪在此配置时间之后运行的查询。有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 。 <br/> `asinfo -v "set-config:context=service;query-untracked-time-ms=5000"` |
| query-worker-threads | 15 | | | 节点上的专用I / O线程数。有关调整和配置二级查询的限制的更多详细信息，请参阅 [Managing Queries](https://docs.aerospike.com/docs/operations/manage/queries/index.html) 。 <br/> `asinfo -v "set-config:context=service;query-worker-threads=20"` |
| ~~replication-fire-and-forget~~ | false | | Removed : 3.9 | 在3.9中删除。如果为true，将不等待副本写入的答复。如果初始尝试失败，将不会重试。替换为 : `write-commit-level-override` 。 <br/> 与 `respond-client-on-master-completion` 相比，提高了写入性能。 | 
| ~~respond-client-on-master-completion~~ | false | | Removed : 3.3.26 | 在3.3.26中删除。如果为true，将不等待副本写入的答复。如果初始操作失败，将多次重试。替换为 : `write-commit-level-override` 。 <br/> 提高写入性能。 <br/> 删除此全局设置是为了支持客户端每个 transactions 的写入提交级别策略和服务器每个名称空间的 `write-commit-level-override` 设置。 |
| ~~scan-max-active~~ | 100 | | Introduced : 3.6.0  Removed : 4.7.0 | 允许的最大活动扫描数。值范围：0-200。 <br/> `asinfo -v "set-config:context=service;scan-max-active=150"` |
| scan-max-done | 100 | | Introduced : 3.6.0 | 保留用于监控的已完成扫描的最大数量。值范围：0-1000。 <br/> `asinfo -v "set-config:context=service;scan-max-done=500"` |
| ~~scan-max-udf-transactions~~ | 32 | | Introduced : 3.6.0 Removed : 4.7.0 | 每个 UDF 后台扫描的最大活动 transactions 数量。实际上，限制了从 UDF 扫描发送到 transaction 队列的 transactions 数量。 <br/> `asinfo -v "set-config:context=service;scan-max-udf-transactions=64"`  <br/> 例如，让我们考虑设置为32的 `scan-max-udf-transactions` 。对于UDF扫描，扫描线程会将32个 transactions 排入 transaction queues 。尝试将第33个 transaction 放入队列时，如果前32个 transactions 中没有一个完成，则扫描线程将在重新尝试该 transaction 之前进入休眠状态。 <br/> 有关更多详细信息，请参阅 [FAQ on Scans](https://discuss.aerospike.com/t/faq-scans-in-aerospike/2704) 和 [Scan UDF Throttling Guide](https://discuss.aerospike.com/t/how-to-throttle-scan-udfs/5377/1) |
| ~~scan-priority~~ | 200 | | Removed : 3.6.0 | scan 的节流控制。 200表示每200条记录读取1微秒的睡眠。不要设置为0。 |
| ~~scan-retransmit~~ | 3600000 | | Removed : 3.3.5 | 在重新发送扫描任务之前等待的时间（以毫秒为单位）。 |
| ~~scan-threads~~ | 4 | | Introduced : 3.6.0 Removed : 4.7.0 | 扫描线程池的大小。可以动态增加或减少。对于3.16之前的版本，最大允许值为32；对于3.16.0.1及更高版本，最大允许值为128。 <br/> `asinfo -v "set-config:context=service;scan-threads=8"` <br/> 典型的建议值是匹配主机上的内核数。增加此值可能会影响常规 transactions 的性能。 |
| scan-threads-limit | 128 | | Introduced : 4.7.0 | 所有扫描允许的最大线程数。可以动态增加或减少。值范围：1-1024。 <br/> `asinfo -v "set-config:context=service;scan-threads-limit=64"` |
| service-threads | (5 * #cpu) or #cpu | | | 接收客户端请求并执行 transactions 的线程数量。在 multi-socketed 系统上，如果启用了 `Non-Uniform Memory Access (NUMA) pinning`，则每个 Aerospike 实例仅计入正在服务的 socket 上的 CPU 内核。 <br/> - 对于版本 4.7 和更高版本，如果至少有一个 SSD 命名空间，则默认值为 CPU 内核数的五倍，否则，默认值为 CPU 的内核数。请注意，如果将所有的命名空间都配置为 `data-in-memory` 中（具有或不具有持久性），这将再次默认为 CPU 内核数。从版本 5.1 开始，Persistent memory 命名空间与 `data-in-memory` 命名空间等效，以计算此默认值。取值范围是 1-4096 。 <br/> - 对于 3.12 到 4.7，默认为 CPU 内核数，值范围为 1-256 。 <br/> 对于 4.7 版及更高版本，除非没有 SSD 命名空间（即，所有命名空间均为 `data-in-memory`），否则建议值为 CPU 数量的五倍，在这种情况下，建议值为 CPU 数量。在 4.7 之前的版本中，推荐值为 CPU 数量。自版本 3.12 起自动默认值为建议值。对于 4.7 之前的版本为静态。 |
| sindex-builder-threads | 4 | | Introduced : 3.6 | 用于建立二级索引的线程数。可以为服务器已经在运行时创建的二级索引动态设计。在配置文件中为在启动过程中生成或重建的二级索引设置。可以为此配置设置最大值32。有关更多详细信息，请参阅 [knowledge base article](https://discuss.aerospike.com/t/how-to-speed-up-secondary-index-creation-or-re-building/2795) 。 <br/> `asinfo -v 'set-config:context=service;sindex-builder-threads=5'` |
| sindex-gc-max-rate | 50000 | | Introduced : 3.14.0 | 二级索引条目垃圾收集器的最大处理速率（每秒条目）。这是指已由二级索引（`entries`）建立索引的记录数。 <br/> `asinfo -v "set-config:context=service;sindex-gc-max-rate=10000"` <br/> 这是一个上限。一般来说，如果条目被垃圾收集，那么有效的比率会更低。注意，在3.14.0版本中。X，默认值是1000000，这可能会影响整个系统性能。 |
| sindex-gc-period | 10 |  | Introduced : 3.14.0 | 二级索引垃圾会首先从运行的时间间隔(秒)。 <br/> 从 4.3.0 版本开始，将 `sindex-gc-period` 设置为 0 将禁用二级索引垃圾收集。 <br/> `asinfo -v "set-config:context=service;sindex-gc-period=100"` <br/> 如果在进行sindex垃圾收集时将`sindex-gc-period` 动态设置为零，则当前循环将完成，然后垃圾收集将处于休眠状态。 |
| ~~storage-benchmarks~~ | false | | Removed : 3.9 | 设置为 true 可以收集 storage benchmarks 并将其转储到日志中，以通过 asloglatency 进行分析。在3.9中删除，并替换为启用命名空间级别配置的 benchmarks 。有关详细信息，请参阅 [Histograms from Aerospike Logs](https://docs.aerospike.com/docs/operations/monitor/latency/index.html)  。|
| ticket-interval | 10 | | | 全局配置，以秒为单位的频率将 `ticker` 信息打印到日志中的频率。 <br/> `asinfo -v "set-config:context=service;ticker-interval=20"` |
| transaction-max-ms | 1000 | | | 在服务器上使 transaction 超时之前等待成功的时间（以毫秒为单位）（通常 (但不一定)在复制副本写入或复制解析期间)。这将被客户端 transaction（如果设置）覆盖。花费时间超过此时间（或客户端策略中指定的时间）的 transaction 将返回超时，并勾选 `client_write_timeout` 指标。 <br/> `asinfo -v "set-config:context=service;ticker-interval=20"` <br/> 在 3 个不同的地方检察 `transaction-max-ms`（或指定的客户端设置超时） ：<br/> - transaction 开始时 <br/> - 在 `rw-hash`等待时，每 130ms （请参阅 `rw_in_progress`） <br/> - 在 proxy-hash 中等待时每 75ms 一次（请参阅 `proxy_in_progress`） <br/> 因此，默认情况下，如果客户端未指定 transaction 超时（这与客户端重试策略无关），则 transaction 不会在服务器节点之间重传（通常用于写配置文件或重复解析）。如果客户端指定了 transaction 超时，或者增加了 `transaction-max-ms`，则将在此时间范围内重试一次 transaction。例如，如果客户端将 transaction 超时指定为 8 秒，则假设存在网络问题，导致无法在其 prole 端处理写入，则 fabric transaction 将最多重试三次，间隔从 1s 开始（默认值 `transaction-retry-ms` ），并在每次后续重试时加倍。 |
| ~~transaction-pending-limit~~ | 20 | | Removed : 4.3.1.3 | 从版本 4.3.1.3 开始移至 namespace 上下文。可以在队列中等待同一个 key 上工作的最大挂起 transactions。值为 0 将消除限制（无限制），值为 1 将允许最多 1 个 transaction 在已进行的 transaction 后的 rw-hash 中排队。 <br/> `asinfo -v "set-config:context=service;transaction-pending-limit=3"` <br/> 如果应用程序更频繁地使用少量 key ，则增加此限制。如果超过该值，则溢出的 transactions 将失败，并且客户端将收到错误代码14 Key Busy（在服务器端在 `fail_key_busy` 统计信息下进行跟踪）。 |
| ~~transaction-repeatable-read~~ | false | | Removed : 3.3.26 | 此标志在集群重新配置期间暂时放松读取一致性，以保持较高的读取性能。 废弃者 : `read-consistency-level-override` <br/> 删除此全局设置是为了支持客户端每个 transaction 读取一致性级别策略和服务器每个命名空间 `read-consistency-level-override` 设置。 |
| transaction-retry-ms | 1002 | | | 重试 transaction 之前等待成功的时间（以毫秒为单位）。这也将控制与迁移相关的 transaction，直到版本 3.10.1 。在 3.10.1 之后的版本中，新的配置 `migration-retransmit-ms` 用于与迁移相关的重传。默认值 1002 是为了避免默认情况下基于默认 `transaction-max-ms` 的重传。 <br/>  `asinfo -v "set-config:context=service;transaction-retry-ms=500"` | 
| ~~transaction-threads-per-queue~~ | 4 | | Removed : 4.7 | 每个 transaction 队列的线程数量。这些线程将消耗来自 transaction 队列的请求。在 3.11 之前的版本中，这不是动态可配置的。值范围：1-256 。 <br/>  `asinfo -v "set-config:context=service;transaction-threads-per-queue=6"` <br/> 最佳值将取决于工作负载和对象大小。对于对象大小较小（~ 1KiB）的 `none-data in memory` 命苦，每个 transaction 队列 3 个线程是最佳值。通常，低数字（3到8之间）就足够了。 transaction 线程的总数将是 `transaction-queues` 和 `transaction-threads-per-queue` 的乘积。 <br/> 4.7 版本统一 transaction threads 和 service threads。从 4.7 版本开始，service threads 是唯一可用于控制 network 和 transaction processing threads 数量的配置选项。 |
| ~~write-duplicate-resolution-disable~~ | false | | Removed : 3.15.0.1 | 在 3.15.0.1 版本中删除。从 3.15.1.3 开始，替换为命名空间级别配置 `disbale-write-dup-res`。禁用写入 duplicate resolution。从节点维护/故障或分区中恢复后，需要执行写入 duplicate resolution。在应用更新之前，我们会跟踪记录的不同版本。仅在迁移中可能存在给定分区的多个版本时，这才适用。 <br/> 设置 true 将禁用写入 duplicate resolution，这可以提高迁移期间的写性能，但也可能导致更新丢失。由于最近版本中 duplicate resolution 对性能的影响已经大大降低，因此已删除此设置。对于性能比可能不准确的更新记录更重要的特殊情况，在版本 3.15.1.3 的命名空间级别上重新引入的此配置，名称为 `disable-write-dup-res` 。 |